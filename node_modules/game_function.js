(function() {
	// Abstract method? im so gud Kappa
	module.exports = {
		GameMethods : function (type)
		{
			if (type == "games")
				return new Games();
			if (type == "players")
				return new Players();
		}
	};
}());

// Array of Players waiting
function Players ()
{
	this.players = new Array();
}

Players.prototype.add = function (client)
{
	this.players.push(client);
}

// Checks if there are 2 (or more) players waiting and creates a new Game if there are
Players.prototype.checkRdy = function ()
{
	if ( this.players.length >= 2 )
	{
		var game = new Game();
		game.player1.setClientID ( this.players[0] );
		game.player2.setClientID ( this.players[1] );
		this.players.splice( 0, 2 );
		return game;
	}
	return false;
}

function Games ()
{
	this.games = new Array();
}

// Create a new Game
Games.prototype.add = function (game)
{
	this.games.push(game);
}

Games.prototype.remove = function (gameID)
{
	this.games.splice(gameID, 1);
}

// New Player e y am i doing this in german
function Spieler () 
{
	this.client;
	this.hp = 30;
	this.meeles = new Feld('meele');
	this.ranges = new Feld('ranges');
	this.hand = new Array();
	this.deck = new Deck;
	this.gameID;
}


Spieler.prototype.setClientID = function (id)
{
	this.client = id;
}


Spieler.prototype.setGameID = function (id)
{
	this.gameID = id;
}


Spieler.prototype.getClientID = function ()
{
	return this.client;
}



function Game()
{
	this.player1 = new Spieler();
	this.player2 = new Spieler();
	this.am_zug;
	this.nicht_am_zug;
	this.rounds = 0;
}


Game.prototype.start = function ()
{
	// dont know if i actually need this ^.^
	console.log("the game is now starting kappa");
}



// -1 means nothing there
function Feld(type)
{
	this.type = type;
	this.size = [-1, -1,-1];
}


function Minion(name, attack, health, text)
{
	this.name = name;
	this.attack = attack;
	this.health = health;
	this.text = text;
}


function Spell(name, buffAttack, buffHealth, text)
{
	this.name = name;
	this.buffAttack = buffAttack;
	this.buffHealth = buffHealth;
	this.text = text;
}


// KEK...
function Deck()
{
	this.deck = [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
				1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1];
}


// TODO:	- Random Cards from Deck
//			- Remove Cards from Deck
//			- Put Cards in Hand
Spieler.prototype.draw = function (amount)
{
	received_cards = [0,0,1];
	this.hand.push(received_cards[0],received_cards[1],received_cards[2]);
	return received_cards;
}



// http://stackoverflow.com/questions/6274339/how-can-i-shuffle-an-array-in-javascript
function shuffle(a) {
    var j, x, i;
    for (i = a.length; i; i -= 1) {
        j = Math.floor(Math.random() * i);
        x = a[i - 1];
        a[i - 1] = a[j];
        a[j] = x;
    }
}
